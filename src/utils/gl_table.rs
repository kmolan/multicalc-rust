pub const MAX_GL_ORDER: usize = 20;

pub fn get_gl_weights_and_abscissae(n: usize) -> (Vec<f64>, Vec<f64>)
{
    let mut result_abscissae = vec![0.0; n];
    let mut result_weight = vec![0.0; n];

    let ref_abs: &[f64] = match n 
    {
        2 => &LEGENDRE_ABSCISSA_2[..],
        3 => &LEGENDRE_ABSCISSA_3[..],
        4 => &LEGENDRE_ABSCISSA_4[..],
        5 => &LEGENDRE_ABSCISSA_5[..],
        6 => &LEGENDRE_ABSCISSA_6[..],
        7 => &LEGENDRE_ABSCISSA_7[..],
        8 => &LEGENDRE_ABSCISSA_8[..],
        9 => &LEGENDRE_ABSCISSA_9[..],
        10 => &LEGENDRE_ABSCISSA_10[..],
        11 => &LEGENDRE_ABSCISSA_11[..],
        12 => &LEGENDRE_ABSCISSA_12[..],
        13 => &LEGENDRE_ABSCISSA_13[..],
        14 => &LEGENDRE_ABSCISSA_14[..],
        15 => &LEGENDRE_ABSCISSA_15[..],
        16 => &LEGENDRE_ABSCISSA_16[..],
        17 => &LEGENDRE_ABSCISSA_17[..],
        18 => &LEGENDRE_ABSCISSA_18[..],
        19 => &LEGENDRE_ABSCISSA_19[..],
        20 => &LEGENDRE_ABSCISSA_20[..],
        _ => panic!("Legendre quadrature is limited from to n = 1 to {}", MAX_GL_ORDER),
    };

    let ref_weight: &[f64] = match n 
    {
        2 => &LEGENDRE_WEIGHT_2[..],
        3 => &LEGENDRE_WEIGHT_3[..],
        4 => &LEGENDRE_WEIGHT_4[..],
        5 => &LEGENDRE_WEIGHT_5[..],
        6 => &LEGENDRE_WEIGHT_6[..],
        7 => &LEGENDRE_WEIGHT_7[..],
        8 => &LEGENDRE_WEIGHT_8[..],
        9 => &LEGENDRE_WEIGHT_9[..],
        10 => &LEGENDRE_WEIGHT_10[..],
        11 => &LEGENDRE_WEIGHT_11[..],
        12 => &LEGENDRE_WEIGHT_12[..],
        13 => &LEGENDRE_WEIGHT_13[..],
        14 => &LEGENDRE_WEIGHT_14[..],
        15 => &LEGENDRE_WEIGHT_15[..],
        16 => &LEGENDRE_WEIGHT_16[..],
        17 => &LEGENDRE_WEIGHT_17[..],
        18 => &LEGENDRE_WEIGHT_18[..],
        19 => &LEGENDRE_WEIGHT_19[..],
        20 => &LEGENDRE_WEIGHT_20[..],
        _ => panic!("Legendre quadrature is limited from to n = 1 to {}", MAX_GL_ORDER),
    };

    if n % 2 == 0
    {
        for i in 0..ref_abs.len()
        {
            result_abscissae[2*i] = -ref_abs[i];
            result_abscissae[2*i + 1] = ref_abs[i];

            result_weight[2*i] = ref_weight[i];
            result_weight[2*i + 1] = ref_weight[i];
        }
    }
    else
    {
        result_abscissae[0] = 0.0; //this is always zero
        result_weight[0] = ref_weight[0];

        for i in 1..ref_weight.len() 
        {
            result_abscissae[i] = -ref_abs[i - 1];
            result_weight[i] = ref_weight[i];

            result_abscissae[n - i - 1] = ref_abs[i - 1];
            result_weight[n - i - 1] = ref_weight[i];
        }
    }

    return (result_weight, result_abscissae);
}


// =============================================================================
// Table taken from https://pomax.github.io/bezierinfo/legendre-gauss.html
// =============================================================================
const LEGENDRE_ABSCISSA_2: [f64; 1] = [0.577350269189626];
const LEGENDRE_ABSCISSA_3: [f64; 1] = [0.774596669241483];
const LEGENDRE_ABSCISSA_4: [f64; 2] = [0.339981043584856, 0.861136311594053];
const LEGENDRE_ABSCISSA_5: [f64; 2] = [0.538469310105683, 0.906179845938664];
const LEGENDRE_ABSCISSA_6: [f64; 3] = [0.238619186083197, 0.661209386466265, 0.932469514203152];
const LEGENDRE_ABSCISSA_7: [f64; 3] = 
[
    0.405845151377397,
    0.741531185599394,
    0.949107912342759,
];
const LEGENDRE_ABSCISSA_8: [f64; 4] = 
[
    0.183434642495650,
    0.525532409916329,
    0.796666477413627,
    0.960289856497536,
];
const LEGENDRE_ABSCISSA_9: [f64; 4] = 
[
    0.324253423403809,
    0.613371432700590,
    0.836031107326636,
    0.968160239507626,
];
const LEGENDRE_ABSCISSA_10: [f64; 5] = 
[
    0.148874338981631,
    0.433395394129247,
    0.679409568299024,
    0.865063366688985,
    0.973906528517172,
];
const LEGENDRE_ABSCISSA_11: [f64; 5] = 
[
    0.269543155952345,
    0.519096129110681,
    0.730152005574049,
    0.887062599768095,
    0.978228658146057,
];
const LEGENDRE_ABSCISSA_12: [f64; 6] = 
[
    0.125333408511469,
    0.367831498918180,
    0.587317954286617,
    0.769902674194305,
    0.904117256370475,
    0.981560634246719,
];
const LEGENDRE_ABSCISSA_13: [f64; 6] = 
[
    0.230458315955135,
    0.448492751036447,
    0.642349339440340,
    0.801578090733310,
    0.917598399222978,
    0.984183054718588,
];
const LEGENDRE_ABSCISSA_14: [f64; 7] = 
[
    0.108054948707344,
    0.319112368927890,
    0.515248636358154,
    0.687292904811685,
    0.827201315069765,
    0.928434883663574,
    0.986283808696812,
];
const LEGENDRE_ABSCISSA_15: [f64; 7] = 
[
    0.201194093997435,
    0.394151347077563,
    0.570972172608539,
    0.724417731360170,
    0.848206583410427,
    0.937273392400706,
    0.987992518020485,
];
const LEGENDRE_ABSCISSA_16: [f64; 8] = 
[
    0.095012509837637,
    0.281603550779259,
    0.458016777657227,
    0.617876244402644,
    0.755404408355003,
    0.865631202387832,
    0.944575023073233,
    0.989400934991650,
];
const LEGENDRE_ABSCISSA_17: [f64; 8] = 
[
    0.178484181495847856,
    0.351231763453876315,
    0.512690537086476968,
    0.657671159216690766,
    0.781514003896801407,
    0.880239153726985902,
    0.950675521768767761,
    0.99057547531441734,
];
const LEGENDRE_ABSCISSA_18: [f64; 9] = 
[
    0.084775013041735301,
    0.25188622569150551,
    0.411751161462842646,
    0.559770831073947535,
    0.691687043060353208,
    0.803704958972523116,
    0.892602466497555739,
    0.955823949571397755,
    0.991565168420930947,
];
const LEGENDRE_ABSCISSA_19: [f64; 9] = 
[
    0.160358645640225376,
    0.316564099963629832,
    0.464570741375960946,
    0.600545304661681024,
    0.720966177335229379,
    0.822714656537142825,
    0.903155903614817902,
    0.960208152134830031,
    0.992406843843584403,
];
const LEGENDRE_ABSCISSA_20: [f64; 10] = 
[
    0.076526521133497334,
    0.227785851141645078,
    0.373706088715419561,
    0.510867001950827098,
    0.636053680726515026,
    0.746331906460150793,
    0.839116971822218823,
    0.912234428251325906,
    0.963971927277913791,
    0.993128599185094925,
];


const LEGENDRE_WEIGHT_2: [f64; 1] = [1.0];
const LEGENDRE_WEIGHT_3: [f64; 2] = [0.888888888888889, 0.555555555555556];
const LEGENDRE_WEIGHT_4: [f64; 2] = [0.652145154862546, 0.347854845137454];
const LEGENDRE_WEIGHT_5: [f64; 3] = [0.568888888888889, 0.478628670499366, 0.236926885056189];
const LEGENDRE_WEIGHT_6: [f64; 3] = [0.467913934572691, 0.360761573048139, 0.171324492379170];
const LEGENDRE_WEIGHT_7: [f64; 4] =
[
    0.417959183673469,
    0.381830050505119,
    0.279705391489277,
    0.129484966168870,
];
const LEGENDRE_WEIGHT_8: [f64; 4] =
[
    0.362683783378362,
    0.313706645877887,
    0.222381034453374,
    0.101228536290376,
];
const LEGENDRE_WEIGHT_9: [f64; 5] =
[
    0.330239355001260,
    0.312347077040003,
    0.260610696402935,
    0.180648160694857,
    0.081274388361574,
];
const LEGENDRE_WEIGHT_10: [f64; 5] =
[
    0.295524224714753,
    0.269266719309996,
    0.219086362515982,
    0.149451349150581,
    0.066671344308688,
];
const LEGENDRE_WEIGHT_11: [f64; 6] =
[
    0.272925086777901,
    0.262804544510247,
    0.233193764591990,
    0.186290210927734,
    0.125580369464905,
    0.055668567116174,
];
const LEGENDRE_WEIGHT_12: [f64; 6] =
[
    0.249147045813403,
    0.233492536538355,
    0.203167426723066,
    0.160078328543346,
    0.106939325995318,
    0.047175336386512,
];
const LEGENDRE_WEIGHT_13: [f64; 7] =
[
    0.232551553230874,
    0.226283180262897,
    0.207816047536889,
    0.178145980761946,
    0.138873510219787,
    0.092121499837728,
    0.040484004765316,
];
const LEGENDRE_WEIGHT_14: [f64; 7] =
[
    0.215263853463158,
    0.205198463721290,
    0.185538397477938,
    0.157203167158194,
    0.121518570687903,
    0.080158087159760,
    0.035119460331752,
];
const LEGENDRE_WEIGHT_15: [f64; 8] =
[
    0.202578241925561,
    0.198431485327111,
    0.186161000015562,
    0.166269205816994,
    0.139570677926154,
    0.107159220467172,
    0.070366047488108,
    0.030753241996117,
];
const LEGENDRE_WEIGHT_16: [f64; 8] =
[
    0.189450610455069,
    0.182603415044924,
    0.169156519395003,
    0.149595988816577,
    0.124628971255534,
    0.095158511682493,
    0.062253523938648,
    0.027152459411754,
];
const LEGENDRE_WEIGHT_17: [f64; 9] =
[
    0.179446470356206526,
    0.17656270536699265,
    0.168004102156450045,
    0.154045761076810288,
    0.13513636846852547,
    0.111883847193403971,
    0.085036148317179181,
    0.055459529373987201,
    0.024148302868547932,
];
const LEGENDRE_WEIGHT_18: [f64; 9] =
[
    0.169142382963143592,
    0.16427648374583272,
    0.15468467512626524,
    0.140642914670650651,
    0.12255520671147846,
    0.100942044106287166,
    0.07642573025488906,
    0.049714548894969796,
    0.02161601352648331,
];
const LEGENDRE_WEIGHT_19: [f64; 10] =
[
    0.161054449848783696,
    0.158968843393954348,
    0.152766042065859667,
    0.14260670217360661,
    0.128753962539336228,
    0.111566645547333995,
    0.091490021622449999,
    0.06904454273764123,
    0.0448142267656996,
    0.019461788229726477,
];
const LEGENDRE_WEIGHT_20: [f64; 10] =
[
    0.15275338713072585,
    0.149172986472603747,
    0.142096109318382051,
    0.13168863844917663,
    0.118194531961518417,
    0.10193011981724044,
    0.083276741576704749,
    0.062672048334109064,
    0.040601429800386941,
    0.0176140071391521183,
];